!function(){new Vue({el:"#vue-search",data:JSON.parse(document.getElementById("vue-search").getAttribute("data-env")),methods:{lastSearch:0,searchSubmit:function(){var vue=this;this.forms.search.errors={},this.forms.search.loading=!0,this.formAjax(this.forms.search,function(r){vue.forms.search.loading=!1,vue.searched=!0,vue.showingBar="",vue.showingClicks="",r.ok&&r.data?(vue.stats=r.data.stats,vue.ranged=r.data.ranged,vue.date_min=r.data.date_min,vue.date_max=r.data.date_max,vue.hasStats=vue.stats.sent.total>0,vue.hasClicks=vue.stats.clicks.total>0,vue.ranged||(vue.stats.volume.this_month.labels.length>0?vue.showBar("this_month"):stats.volume.this_year.labels.length>0?vue.showBar("this_year"):stats.volume.years.labels.length>1&&vue.showBar("years")),vue.hasClicks&&(vue.stats.clicks.template.length>0?vue.showingClicks="template":vue.stats.clicks.subject.length>0?vue.showingClicks="subject":vue.stats.clicks.domain.length>0?vue.showingClicks="domain":vue.stats.clicks.url.length>0&&(vue.showingClicks="url"))):r.errors?vue.forms.search.errors=r.errors:vue.forms.search.errors.other="The server garbled the last response. :(",vue.scrollTo()})},showBar:function(bar){this.showingBar=bar,Vue.nextTick(function(){var evt=window.document.createEvent("UIEvents");evt.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(evt)})}},mounted:function(){this.searchSubmit()}});Vue.component("chartist",{template:'<div ref="chart" :class="[ratio, noData]" v-text="message"></div>',mounted:function(){this.draw()},props:{ratio:{type:String},data:{type:Object},options:{type:Object},type:{type:String,required:!0,validator:function(val){return"Pie"===val||"Line"===val||"Bar"===val}},eventHandlers:{type:Array},responsiveOptions:{type:Array}},data:function(){return{chart:null,error:{onError:!1,message:""},noData:"",message:"",classNoData:this.options.classNoData}},methods:{clear:function(){this.noData="",this.message="",this.error.onError&&(this.error={onError:!1,message:""})},draw:function(){if(this.haveNoData())return this.setNoData();this.clear(),this.chart=new Chartist[this.type](this.$refs.chart,this.data,this.options,this.responsiveOptions),this.setEventHandlers()},haveNoData:function(){return!this.data||this.data.series.length<1||"Pie"!==this.type&&!this.options.distributeSeries&&(this.data.labels.length<1||this.data.series.every(function(serie){return Array.isArray(serie)?!serie.length:!serie.data.length}))},redraw:function(){return this.error.onError?this.draw():this.haveNoData()?this.setNoData():(this.clear(),void this.chart.update(this.data,this.options))},resetEventHandlers:function(eventHandlers,oldEventHanlers){var _iteratorError,_iterator,_iteratorNormalCompletion=!0,_didIteratorError=!1;try{for(_iterator=oldEventHanlers[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var item=_step.value;this.chart.off(item.event,item.fn)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}var _iteratorError2,_iterator2,_iteratorNormalCompletion2=!0,_didIteratorError2=!1;try{for(_iterator2=eventHandlers[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _item=_step2.value;this.chart.on(_item.event,_item.fn)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}},setEventHandlers:function(){if(this.eventHandlers){var _iteratorError3,_iterator3,_iteratorNormalCompletion3=!0,_didIteratorError3=!1;try{for(_iterator3=this.eventHandlers[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var _item2=_step3.value;this.chart.on(_item2.event,_item2.fn)}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}},setNoData:function(){this.error={onError:!0,message:options.messageNoData},this.noData=this.classNoData,this.message=this.error.message}},watch:{ratio:"redraw",options:"draw",data:{handler:"redraw",deep:!0},type:"draw",eventHandlers:"resetEventHandlers"}}),Vue.prototype.pieOptions={showLabel:!1,plugins:[Chartist.plugins.legend({clickable:!1})]},Vue.prototype.lineOptions={showArea:!0,showPoint:!1,fullWidth:!0,showLabel:!1,axisX:{showGrid:!1,showLabel:!1,offset:0},chartPadding:0,low:0},Vue.prototype.barOptions={}}();