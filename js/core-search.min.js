!function(){var wh_app=new Vue({el:"#vue-search",data:JSON.parse(document.getElementById("vue-search").getAttribute("data-env")),methods:{lastSearch:0,searchSubmit:function(){var vue=this;this.forms.search.errors={},this.forms.search.loading=!0;var soup=JSON.parse(JSON.stringify(this.forms.search));delete soup.page,delete soup.errors,delete soup.loading,delete soup.n,delete soup.action;var hash=this.hash(soup);hash!==this.lastSearch&&(this.forms.search.page=0,this.lastSearch=hash),this.formAjax(this.forms.search,function(r){vue.forms.search.loading=!1,vue.searched=!0,vue.results={page:0,pages:0,total:0,items:[]},r.ok&&r.data?vue.results=r.data:r.errors?vue.forms.search.errors=r.errors:vue.forms.search.errors.other="The server garbled the last response. :(",vue.scrollTo()})},pageSubmit:function(change){if(0!==(change=parseInt(change,10)||0)&&(this.forms.search.page+=change,this.forms.search.page<0?this.forms.search.page=0:this.forms.search.page>this.results.pages&&(this.forms.search.page=this.results.pages),this.forms.search.page!==this.results.page))return this.searchSubmit()},getMessage:function(message,options,data){this.modal=!0,message=message.replace(/\?wh_link=[A-Z0-9]{20}/g,"#tracking-removed-for-preview"),message=message.replace(/<img\s.[^>]*>/g,function(match){return-1!==match.indexOf("?wh_image")?"":match}),"string"==typeof options&&(this.preview.options=options),"string"==typeof data&&(this.preview.data=data),Vue.nextTick(function(){var iframe=document.getElementById("wh-modal--message");iframe.contentWindow.contents=message,iframe.src="javascript:window.contents"})}},mounted:function(){this.searchSubmit()}});document.addEventListener("keyup",function(e){("key"in(e=e||window.event)&&("Escape"==e.key||"Esc"==e.key)||27==e.keyCode)&&(wh_app.modal=!1)})}();